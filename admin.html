<!DOCTYPE html>
<html>
	<head>
        <meta charset="utf-8" />
		<title>Admin Page</title>
		<script src="js/jquery-2.0.3.min.js"></script>
	</head>
	<body>
		<h3>Welcome </h3>
		<div id="main" onload="mainMenu()">
		</div>
		<a id="logout" href="#">Logout</a>
	</body>
	<script>
	   $(document).ready(function(){
            $("a#logout").click(function(e){
                e.preventDefault();
                $.ajax({
                    url: "controller.php?action=logout",
                    beforeSend: function (xhr) {
                        xhr.overrideMimeType("application/json; charset=utf8");
                    }
                }).done(function (data){
                    if (data["logout"])
                    {
                        localStorage.removeItem("session");    
                        window.location.href = "login.html";
                    }
                });
            });
            
            $("div#main").on("click", "a#menu", function(e) {
                $("div#main").html("<p>Food!</p><form id='imageupload' method='post' 'enctype='multipart/form-data'><label for='menuform'>Menu: </label><input type='file' name='foodmenu' /><input type='submit' value='Υποβολή'/></form><a id='back' href='#'>Επιστροφή</a>");
            });
            
            $("div#main").on("click", "a#schedule", function(e) {
                $("div#main").html("<p>No Route to Host!</p><form id='imageupload' method='post' enctype='multipart/form-data'><label for='scheduleform'>Menu: </label><input type='file' name='buschedule' /><input type='submit' value='Υποβολή'/></form><a id='back' href='#'>Επιστροφή</a>");
            });
            
            $("div#main").on("click", "a#announcements", function(e) {
                $("div#main").html("<p>Πάρτι</p><form id='announce' method='post'><label for='announcementsform'>Menu: </label><textarea name='announcementsform'></textarea><input type='submit'/></form><a id='back' href='#'>Επιστροφή</a>");
            });
         
        });
        
        $("div#main").on("submit", "#imageupload", function(e) {
            e.preventDefault();
            var formData = new FormData($("form")[0]);
            $.ajax({
                url: 'controller.php?action=fileupload',
                type: 'POST',
                data: formData,
                cache: false,
                contentType: false,
                processData: false
            }).done(function (data){
                alert(data);
            });
        });
        
        $("div#main").on("click", "a#back", function (e) {
                $("div#main").html(mainMenu);
        });

        /*$("div#main").on("load", function (e) {
                $("div#main").html(mainMenu);
        });*/
            
        $(document).ready(function(e) {
            $.ajax({
                url: "controller.php?action=checklogin",
                beforeSend: function (xhr) {
                    xhr.overrideMimeType("application/json; charset=utf8");
                }
            }).done(function (data){
                if (!data['loggedin'])
                {
                    localStorage.removeItem("session");
                    window.location.href = "login.html";
                }
                else
                {                    
                    $("div#main").html(mainMenu);
                }
            });
        });
	
	var mainMenu = "<table>\
	<tr>\
	<td><a id='menu' href='#'>Menu Λέσχης</a></td>\
	<td><a id='schedule' href='#'>Δρομολόγια</a></td>\
	</tr>\
	<tr>\
	<td colspan='2'><a id='announcements' href='#'>Ανακοινώσεις Σπουδαστικού</a></td>\
	</tr>\
	</table>";
	
	</script>
</html>

